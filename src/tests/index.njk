---
layout: base.njk
title: "Acceptance Tests — Kafka + Debezium Lab | CDC: The Missing Manual"
description: "Run acceptance tests for the Kafka + Debezium lab: stack up, connector healthy, topic has change events, and (optional) chaos smoke."
canonicalPath: "/tests/"
head_extra: |
  <meta
        name="description"
        content="Run acceptance tests for the Kafka + Debezium lab: stack up, connector healthy, topic has change events, and (optional) chaos smoke."
      />
      <style>
        /* Minimal local styles for page-specific elements */
        .box {
          border: 1px solid var(--border-color);
          border-radius: 0.5rem;
          padding: 1rem;
          background: var(--color-background-soft);
          margin-bottom: 1.5rem;
        }
        .grid {
          display: grid;
          gap: 1.5rem;
          grid-template-columns: 1fr;
        }
        @media (min-width: 950px) {
          .grid {
            grid-template-columns: 1fr 1fr;
          }
        }
        pre {
          border: 1px solid var(--border-color);
          border-radius: 0.5rem;
          padding: 0.75rem;
          overflow: auto;
          background: var(--color-background-soft);
        }
        .callout {
          border-left: 0.35rem solid #10b981;
          background: #f0fdf4;
        }
        .callout.warn {
          border-left-color: #ef4444;
          background: #fef2f2;
        }
        [data-theme="dark"] .callout {
          background: #162421;
        }
        [data-theme="dark"] .callout.warn {
          background: #2d1e1e;
        }
        .filelist {
          font-family: var(--font-mono);
          font-size: 0.9rem;
          list-style: none;
          padding: 0;
        }
        .filelist li {
          margin: 0.25rem 0;
        }
        .ok {
          color: #16a34a;
        }
        .no {
          color: #ef4444;
        }
        .back-link {
          display: block;
          margin-bottom: 1rem;
          font-weight: 500;
        }
      </style>

---
<a href="quickstarts/" class="back-link">← Back to Quickstarts</a>
      <h1>Acceptance Tests — Kafka + Debezium Lab</h1>
      <p class="muted">
        These tests run on <em>your machine</em> to prove the lab works:
        containers up, connector healthy, topic has change events, and
        (optionally) offsets advance across a restart.
      </p>

      <section class="box">
        <h2>What You’ll Run</h2>
        <ul class="filelist">
          <li>
            <span class="pill">scripts/test_stack.sh</span> — Zookeeper, Broker,
            Connect, PG are running & Connect REST is reachable
          </li>
          <li>
            <span class="pill">scripts/test_connector.sh</span> — Connector
            exists and is <strong class="ok">RUNNING</strong>
          </li>
          <li>
            <span class="pill">scripts/test_events.sh</span> — Topic has data;
            consumed messages parse as JSON and include <code>op</code> ∈
            {c,u,d}
          </li>
          <li>
            <span class="pill">scripts/test_chaos_smoke.sh</span>
            <span class="small">(optional)</span> — Latest offsets increase
            after a controlled connector restart
          </li>
        </ul>
        <p class="muted small">
          Requirements: <code>docker</code>, <code>docker compose</code>,
          <code>curl</code>, <code>jq</code>. Windows users: run under
          <a href="https://learn.microsoft.com/windows/wsl/install">WSL</a> or
          Git Bash.
        </p>
      </section>

      <section class="grid">
        <div class="box">
          <h2>Run Them (Mac/Linux + WSL)</h2>
          <pre><code>chmod +x scripts/*.sh
bash scripts/test_stack.sh
bash scripts/test_connector.sh
bash scripts/test_events.sh
# optional:
bash scripts/test_chaos_smoke.sh</code></pre>
          <p class="muted small">
            Expect green checks (✅). Any ❌ includes the failing step so you
            know what to fix.
          </p>
        </div>
        <div class="box">
          <h2>Windows (PowerShell via WSL)</h2>
          <ol>
            <li>Open “Ubuntu (WSL)”</li>
            <li>
              <code>cd</code> into the lab folder you mounted (
              <code>/mnt/c/Users/you/lab</code>)
            </li>
            <li>Run the same <code>bash</code> commands as left</li>
          </ol>
          <p class="muted small">
            Native PowerShell can work if you have Git Bash; otherwise use WSL.
          </p>
        </div>
      </section>

      <section class="box callout">
        <h2>Customizing (if your names differ)</h2>
        <p>Override env vars inline:</p>
        <pre><code>CONNECT_URL=http://connect:8083 \
CONNECTOR_NAME=my-connector \
TOPIC=my.db.my_table \
bash scripts/test_events.sh</code></pre>
        <p class="muted small">
          Defaults are <code>CONNECT_URL=http://localhost:8083</code>,
          <code>CONNECTOR_NAME=inventory-connector</code>,
          <code>TOPIC=server1.public.app_customer</code>.
        </p>
      </section>

      <section class="box">
        <h2>What “Pass” Means</h2>
        <ul>
          <li>
            <strong>Stack</strong>: All containers are up and Connect’s REST API
            responds
          </li>
          <li>
            <strong>Connector</strong>: The named source connector is RUNNING
            with at least one RUNNING task
          </li>
          <li>
            <strong>Events</strong>: The Debezium topic has data and you can
            parse JSON records with <code>op=c/u/d</code>
          </li>
          <li>
            <strong>Chaos Smoke</strong>: After a connector restart, the topic’s
            latest offset increases (someone is producing / the source didn’t
            wedge)
          </li>
        </ul>
      </section>

      <section class="box">
        <h2>Troubleshooting Quickies</h2>
        <ul>
          <li class="no">
            <strong>No messages consumed</strong>: Generate a change in
            <code>app.customer</code> (insert/update/delete), then re-run
            <code>test_events.sh</code>
          </li>
          <li class="no">
            <strong>Connector not found</strong>: Register it (see lab step
            “register the connector”), or set <code>CONNECTOR_NAME</code>
          </li>
          <li class="no">
            <strong>Timeouts</strong>: Ensure Docker is running;
            <code>docker compose ps</code> should show 4 services up
          </li>
          <li class="no">
            <strong>Permission denied</strong>: Run
            <code>chmod +x scripts/*.sh</code> once
          </li>
        </ul>
      </section>
