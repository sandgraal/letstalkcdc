{% set navModules = series | rejectattr('state', 'equalto', 'disabled') | selectattr('href') | list %}
{% set currentIndex = -1 %}
{% set current = null %}
{% for item in navModules %}
  {% if item.key == seriesKey %}
    {% set currentIndex = loop.index0 %}
    {% set current = item %}
  {% endif %}
{% endfor %}
{% if currentIndex > -1 %}
  {% set prev = navModules[currentIndex - 1] if currentIndex > 0 %}
  {% set next = navModules[currentIndex + 1] if currentIndex + 1 < navModules | length %}
  <div class="container">
    <nav class="series-nav" aria-label="Series navigation">
      <div class="series-nav__group series-nav__group--start{% if not prev %} is-disabled{% endif %}">
        {% if prev %}
          <a class="series-nav__link series-nav__link--prev" href="{{ prev.href }}" aria-label="Previous module: {{ prev.title }}">← {{ prev.title }}</a>
        {% endif %}
      </div>
      <div class="series-nav__group series-nav__group--center">
        <a class="series-nav__link series-nav__link--overview" href="/overview/#series-{% if current.key %}{{ current.key }}{% endif %}">Back to Overview</a>
      </div>
      <div class="series-nav__group series-nav__group--end{% if not next %} is-disabled{% endif %}">
        {% if next %}
          <a class="series-nav__link series-nav__link--next" href="{{ next.href }}" aria-label="Next module: {{ next.title }}">{{ next.title }} →</a>
        {% endif %}
      </div>
    </nav>
  </div>
{% endif %}
